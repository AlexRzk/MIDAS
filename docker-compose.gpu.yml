# GPU-enabled Docker Compose Override
# Usage: docker compose -f docker-compose.yml -f docker-compose.gpu.yml up -d
#
# This file enables GPU support for services that can benefit from it.
# Requires NVIDIA Container Toolkit installed on the host.

services:
  # Feature generator can use GPU for heavy computations if libraries support it
  features:
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
      - CUDA_VISIBLE_DEVICES=0
      # Polars doesn't use GPU directly, but PyTorch/CuPy operations can
      - ENABLE_GPU=true

  # Optional: Add GPU support to processor if using GPU-accelerated libraries
  processor:
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
      - ENABLE_GPU=true
